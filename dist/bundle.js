!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";e.exports=(e,t,r)=>{if(r||(r=t,t="."),function(e,t){if("string"!=typeof e)throw Error("selector should be string!");if("object"!=typeof t)throw Error("obj should be object!")}(e,r),n=r,!Object.keys(n).length)return;var n;const o=e.split(t);return o.some((e,n)=>{const s=o.slice(n).join(t);return void 0!==r[s]?(r=r[s],!0):r[e]?!(r=r[e]):(r=void 0,!0)}),r}},function(e,t,r){"use strict";e.exports=function(e){var t=[],r="abcdefghijklmnopqrstuvwxyz'- ".split(""),n=String.fromCharCode(3);function o(e,r){var o,s,a=t;if(void 0!==r&&"number"!=typeof r)throw new TypeError("Word's rank must be a number");if(void 0===e)throw new TypeError("Word cannot be undefined");for(e=e.toString().toLowerCase().trim(),o=0;s=e.charAt(o);o++)a[s]=a[s]||{},a=a[s];return a[n]=void 0!==r?r:a[n]?a[n]+1:1,this}function s(e,r){var o,l=t,u={};if(void 0===(r=r||{}).suggest&&(r.suggest=!0),Array.isArray(e)){for(u=[],o=0;o<e.length;o++)u.push(s(e[o],r));return u}if(e=e.toString().toLowerCase().trim(),!Number.isNaN(+e))return{found:!0,word:e,rank:0};for(o=0;o<e.length&&l;o++)l=l[e[o]];return u.found=!(!l||!l[n]),u.word=e,u.found?u.rank=l[n]:r.suggest&&(u.suggestions=function(e,t){var r,n=[],o=[],s=[];for((t=t||{}).suggestionsLimit=t.suggestionsLimit||10,e=e.toString().toLowerCase(),o=a(e),r=0;r<o.length&&o.length<t.suggestionsLimit;r++)s=s.concat(a(o[r].word));for(o=o.sort((function(e,t){return t.rank-e.rank})),s=s.sort((function(e,t){return t.rank-e.rank})),r=0;r<o.length&&n.length<t.suggestionsLimit;r++)n.some(i,o[r])||n.push(o[r]);for(r=0;r<s.length&&n.length<t.suggestionsLimit;r++)n.some(i,s[r])||n.push(s[r]);return n}(e,r)),u}function a(e){var t,n,o=[],a=function(e){var t=s(e,{suggest:!1});t.found&&o.push(t)};for(t=0;t<e.length;t++)a(e.slice(0,t)+e.slice(t+1));for(t=0;t<e.length-1;t++)a(e.slice(0,t)+e.slice(t+1,t+2)+e.slice(t,t+1)+e.slice(t+2));for(t=0;t<e.length;t++)for(n=0;n<r.length;n++)a(e.slice(0,t)+r[n]+e.slice(t+1));for(t=0;t<=e.length;t++)for(n=0;n<r.length;n++)a(e.slice(0,t)+r[n]+e.slice(t));return o}function i(e){return this.word===e.word}function l(e,t,r){var o,s=[];if(!r.depth||!t)return s;for(o in s=s.concat(function(e,t){var r,o=[];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&e[r][n]&&o.push({word:t+r,rank:e[r][n]});return o}(t,e)),t)Object.prototype.hasOwnProperty.call(t,o)&&(s=s.concat(l(e+o,t[o],{depth:r.depth-1})));return s}return function(){if(void 0!==e)if("string"==typeof e){var t,r=e.split(" ");for(t=0;t<r.length;t++)o(r[t],+r[++t]);e=""}else Array.isArray(e)&&(e.forEach((function(e){o(e,1)})),e="")}(),{insert:o,lookup:s,remove:function(e){return s(e,{sugget:!1}).found&&o(e,0),this},search:function(e,r){var n,o,a=[],i=t;for(void 0===(r=r||{}).depth&&(r.depth=3),e=e.toString().toLowerCase().trim(),n=0;n<e.length&&i;n++)i=i[e[n]];return i?(a=l(e,i,r),(o=s(e,{suggest:!1})).found&&a.push({word:e,rank:o.rank}),a.sort((function(e,t){return t.rank-e.rank}))):a}}}},function(e,t,r){"use strict";const n=e=>!Object.keys(e).length,o=e=>e.pop()||[];e.exports=(e,t)=>(t||(t=e,e="."),function(e,t){if("string"!=typeof e)throw Error("divider should be a string!");if("object"!=typeof t)throw Error("obj should be an object!")}(e,t),n(t)?[]:function(e,t){const r=[],[n,s]=a(t,e);r.push(...n);let[i,l]=o(s);for(;l;){const[t,n]=a(l,e,i);r.push(...t),s.push(...n),[i,l]=o(s)}return r}(e,t));const{entries:s}=Object;function a(e,t,r=""){const o=[],a=[];for(const[l,u]of s(e)){const e=r?`${r}${t}${l}`:l;(i=u)&&(e=>"object"==typeof e)(i)&&!n(i)?a.push([e,u]):o.push(e)}var i;return[o,a]}},function(e,t,r){"use strict";r.r(t);const n={data_type:["text","image","dropdown","area","nested"],display:["html-editor","date_picker","color_picker"]},o={data_type:"string",key:"string",label:"string",display:"string",required:"boolean",multi:"boolean",value:"string",schema:"object",choices:"array",is_localizable:"boolean"},s=["data_type","key","label"],a=["data_type","key","label","display","required","multi","value","schema","choices","is_localizable"];var i=r(2),l=r.n(i),u=r(0),c=r.n(u);class d extends Error{constructor(e,t,r,n){super(e),this.message=e,this.jessyString=t,this.found=r,this.expected=n}getDetails(){return{message:this.message,jessyString:this.jessyString,found:this.found,expected:this.expected}}}const h=(e,t)=>(...r)=>t(e(...r));var f=function(...e){return e.reduce(h)};var p=f(e=>{if("dropdown"===e.parent.data_type)return e;throw new d('choices dictates a data_type of "dropdown"!',e.jessyString,e.parent.data_type,"dropdown")},e=>{if(e.value.length>1){if(e.value.every(e=>"object"==typeof e&&!Array.isArray(e)&&"value"in e&&"label"in e&&2===Object.keys(e).length))return e;throw new d('choices array members should be of type object, and have "label" and "value" properties, and no other properties',e.jessyString,e.value,null)}throw new d("choices array should have more than one member",e.jessyString,e.value,null)}),y=r(1),g=r.n(y);function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v{}b(v,"dictionaries",void 0),b(v,"getDictionaries",()=>{if(v.dictionaries)return v.dictionaries;{let e={};return e.property=new g.a(a),e.data_type=new g.a(n.data_type),e.display=new g.a(n.display),v.dictionaries={...e},v.dictionaries}});var w=f(e=>{if(n.data_type.includes(e.value))return e;{let t="";if("string"==typeof e.value){let r=v.getDictionaries().data_type.lookup(e.value);r.suggestions&&r.suggestions.length>0&&r.suggestions[0].found&&(t=' did you mean "'+r.suggestions[0].word+'" ?')}throw new d("Unexpected data_type value!"+t,e.jessyString,e.value,n.data_type)}},e=>{if("nested"===e.value&&"schema"in e.parent||"nested"!==e.value)return e;throw new d("no schema found for nested data_type!",e.jessyString,e.parent.display,"object")},e=>{if("area"===e.value&&"html-editor"===e.parent.display||"area"!==e.value)return e;throw new d('data_type area requires "display":"html-editor" !',e.jessyString,e.parent.display,"html-editor")},e=>{if("dropdown"===e.value&&"choices"in e.parent||"dropdown"!==e.value)return e;throw new d("data_type dropdown requires choices array!",e.jessyString,e.parent.choices,"array")});var m=f(e=>{if(n.display.includes(e.value))return e;{let t="";if("string"==typeof e.value){let r=v.getDictionaries().display.lookup(e.value);r.suggestions&&r.suggestions.length>0&&r.suggestions[0].found&&(t=' did you mean "'+r.suggestions[0].word+'" ?')}throw new d("Unexpected display value!"+t,e.jessyString,e.value,n.display)}},e=>{if("color_picker"===e.value&&"text"===e.parent.data_type||"date_picker"===e.value&&"text"===e.parent.data_type||"color_picker"!==e.value&&"date_picker"!==e.value)return e;throw new d('if display is color or date picker, data_type needs to be "text"',e.jessyString,e.parent.data_type,"text")},e=>{if("html-editor"===e.value&&"area"===e.parent.data_type||"html-editor"!==e.value)return e;throw new d("data_type area is required for display html editor!",e.jessyString,e.parent.data_type,"area")});var j=f(e=>{if(e.value.trim().length>0)return e;throw new d("keys should not be empty!",e.jessyString,e.value,"a key string")},e=>{if(e.value.match(/[^\w-]/))throw new d("keys can only contain a-z A-Z - _ 0-9",e.jessyString,e.value.match(/[^\w-]/)[0],"a valid key string");return e});var _=e=>{if(e.value.trim().length>0)return e;throw new d("label should not be empty!",e.jessyString,e.value,"a descriptive string")};function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class S{constructor(){k(this,"warnings",[])}getWarnings(){return[...this.warnings]}addWarning(e){this.warnings.push(e)}clearWarnings(){this.warnings=[]}}k(S,"instance",void 0),k(S,"getInstance",()=>(S.instance||(S.instance=new S),S.instance));var O=e=>(!1===e.value&&S.getInstance().addWarning({jessyString:e.jessyString,message:"multi defaults to false, no need to set it manually.",type:"others"}),e);var A=e=>(!0===e.value&&S.getInstance().addWarning({jessyString:e.jessyString,message:"required defaults to true, no need to set it manually.",type:"others"}),e);var x=f(e=>{if("nested"===e.parent.data_type)return e;throw new d('schema dictates a data_type of "nested"!',e.jessyString,e.parent.data_type,"nested")},e=>{if(Object.keys(e.value).length>0)return e;throw new d("schema should have children",e.jessyString,e.value,null)});let E={choices:p,data_type:w,display:m,key:j,label:_,multi:O,required:A,schema:x,value:e=>e,is_localizable:e=>(!1===e.value&&S.getInstance().addWarning({jessyString:e.jessyString,message:"is_Localizable defaults to false, no need to set it manually.",type:"others"}),e)};var P=(e,t,r,n)=>{let o=new Map,s=new Map;t.forEach(t=>{"schema"in e[t]&&o.set(t+".schema",!0)}),n.forEach(t=>{"choices"in c()(t,e)&&s.set(t+".choices",!0)});let a=[...Array.from(o.keys()),...Array.from(s.keys()),...r];const i=function(e){return t=>{let r=t.match(/^(.*)\.([^\.]*)$/)[1];if(r)return{jessyString:t,value:c()(t,e),baseObj:e,parent:c()(r,e)};throw new d("invalid jessy string",t,t,"atleast one dot required")}}(e);a.forEach(e=>{if(!e.match(/\.([^\.]*)$/))throw new d("invalid jessy string",e,e,"atleast one dot expected");try{E[e.match(/\.([^\.]*)$/)[1]](i(e))}catch(e){throw e}})};let I=(...e)=>1===e.length?e[0]():e[1](e[0]),q=(e,t)=>"array"===t?Array.isArray(e):typeof e===t,z=(e,t)=>{let r=[];for(let n=0;n<=t;n++)r.push(e[n]);return r.join(".")},L=e=>{let t=!0;if(q(e,"object")){let r=Object.keys(e);return s.forEach(e=>{r.includes(e)||(t=!1)}),t}return!1};var M=e=>{const t=Object.keys(e),r=l()(e),n=((e,t)=>{const r=[...t],n=[];return r.forEach(t=>{e[t].schema&&q(e[t].schema,"object")&&Object.keys(e[t].schema).forEach(e=>{n.push(t+".schema."+e)})}),[...r,...n]})(e,t);return{baseObjectHasChildren:()=>{if(t.length>0)return!0;throw new d("Root object should have children!","Root Object","{}","{...}")},allEntriesAreObjects:()=>{for(const t of n){let r=c()(t,e);if(!q(r,"object"))throw new d("All entries should be Objects!",t,"object"==typeof r?"array":typeof r,"{...}")}return!0},allEssentialProperties:()=>{for(const t of n){let r=c()(t,e);if(!I(r,L))throw new d("All entries should have data_type, key and label properties!",t,r,"{data_type : ...., key : ..., label : ...}")}return!0},allPropertyNamesAreValid:()=>{for(const t of r){let r=t.split(".");if(r.length<2)throw new d("Root object children should be Objects!",t,typeof c()(t,e),"{...}");for(let e=1;e<r.length;e+=2)if(!a.includes(r[e])){let n="",o=v.getDictionaries().property.lookup(r[e]);throw o.suggestions&&o.suggestions.length>0&&o.suggestions[0].found&&(n=' did you mean "'+o.suggestions[0].word+'" ?'),new d("Property name is invalid!"+n,t,r[e],a)}}return!0},allTypesAreCorrect:()=>{for(const t of r){let r=t.split(".");if(r.length<2)throw new d("Root object children should be Objects!",t,typeof c()(t,e),"{...}");for(let t=1;t<r.length;t+=2){let n=z(r,t),s=c()(n,e);if(!q(s,o[r[t]]))throw new d("Incorrect property type!",n,Array.isArray(s)?"array":typeof s,o[r[t]])}}return!0},keysEqualPropertyNames:()=>{for(const t of r){let r=t.match(/([^\.]*)\.key/);if(r){let n=c()(t,e);if(r[1]!==n)throw new d("Keys should equal object names!",t,n,r[1])}}return!0},noNestedInNested:()=>{for(const e of r)if(e.split(/\.schema\b/).length>2)throw new d("There can be only one level of nesting via Schema!",e,"{ schema: { ...: { schema: ... } } }","no nested objects in nested objects");return!0},noMultiInMulti:()=>{let t=r.filter(t=>"multi"===t.match(/\.([^\.]*)$/)[1]&&c()(t,e));for(const r of t){let t=r.split(".");if(t.length>2){let r=t.slice(0,t.length-3).join(".");if(c()(r,e).multi)throw new d("Multi objects can't have nested multi objects in them!",r,"{ multi: true }","no nested multi in multi")}}return!0},isolated:()=>{try{P(e,t,r,n)}catch(e){throw e}},noIsLocalizableFound:()=>{let t=r.reduce((t,r)=>"is_localizable"===r.match(/\.([^\.]*)$/)[1]&&c()(r,e)?t+1:t,0);console.log(t),0===t&&S.getInstance().addWarning({jessyString:"all of schema",message:"found no is_localizable with a value of true, it is recommended to add is_localizable to your production widgets.",type:"no_is_localizable"})}}};globalThis.validator=function(e){let t={};S.getInstance().clearWarnings();try{let r=M(e);!function(...e){e.forEach(e=>{e()})}(r.baseObjectHasChildren,r.allEntriesAreObjects,r.allEssentialProperties,r.allPropertyNamesAreValid,r.allTypesAreCorrect,r.keysEqualPropertyNames,r.noNestedInNested,r.noMultiInMulti,r.isolated,r.noIsLocalizableFound),t.success=!0}catch(e){t.error=e}finally{return t.warnings=S.getInstance().getWarnings(),t}}}]);